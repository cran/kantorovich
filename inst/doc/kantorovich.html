<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Stéphane Laurent" />

<meta name="date" content="2016-05-25" />

<title>The kantorovich package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">The <code>kantorovich</code> package</h1>
<h4 class="author"><em>Stéphane Laurent</em></h4>
<h4 class="date"><em>2016-05-25</em></h4>



<p>The <code>kantorovich</code> package has two main features:</p>
<ul>
<li>It computes the extreme joinings of two probability measures <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\nu\)</span> on a finite set;</li>
<li>It computes the Kantorovich distance between these two measures, for a given distance on their finite state space.</li>
</ul>
<div id="exact-results" class="section level1">
<h1>Exact results</h1>
<p>With the help of the <code>rccd</code> and <code>gmp</code> packages, the <code>kantorovich</code> package can return the <em>exact</em> values of the extreme joinings and of the Kantorovich distance.</p>
<div id="quick-example" class="section level2">
<h2>Quick example</h2>
<p>As an example, take <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\nu\)</span> the uniform probability measures on a finite set having three elements.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu &lt;-<span class="st"> </span>nu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>/<span class="dv">3</span>, <span class="dv">1</span>/<span class="dv">3</span>, <span class="dv">1</span>/<span class="dv">3</span>)</code></pre></div>
<p>The <code>ejoinings</code> function returns the extreme joinings of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\nu\)</span>. In this case these are the <span class="math inline">\(6!\)</span> permutation matrices:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(kantorovich)
<span class="kw">ejoinings</span>(mu, nu)</code></pre></div>
<pre><code>## Message: You should enter mu and nu in rational with the gmp package.</code></pre>
<pre><code>## [[1]]
##           1         2         3
## 1 0.3333333 0.0000000 0.0000000
## 2 0.0000000 0.0000000 0.3333333
## 3 0.0000000 0.3333333 0.0000000
## 
## [[2]]
##           1         2         3
## 1 0.3333333 0.0000000 0.0000000
## 2 0.0000000 0.3333333 0.0000000
## 3 0.0000000 0.0000000 0.3333333
## 
## [[3]]
##           1         2         3
## 1 0.0000000 0.3333333 0.0000000
## 2 0.0000000 0.0000000 0.3333333
## 3 0.3333333 0.0000000 0.0000000
## 
## [[4]]
##           1         2         3
## 1 0.0000000 0.3333333 0.0000000
## 2 0.3333333 0.0000000 0.0000000
## 3 0.0000000 0.0000000 0.3333333
## 
## [[5]]
##           1         2         3
## 1 0.0000000 0.0000000 0.3333333
## 2 0.0000000 0.3333333 0.0000000
## 3 0.3333333 0.0000000 0.0000000
## 
## [[6]]
##           1         2         3
## 1 0.0000000 0.0000000 0.3333333
## 2 0.3333333 0.0000000 0.0000000
## 3 0.0000000 0.3333333 0.0000000</code></pre>
<p>Since <code>mu</code> and <code>nu</code> were unnamed, the vector names <code>c(1,2,3)</code> has been automatically assigned to them. The Kantorovich distance between <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\nu\)</span> is relative to a given distance on the state space of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\nu\)</span>, represented by their vector names. By default, the <code>kantorovich</code> package takes the discrete <span class="math inline">\(0\mathrm{-}1\)</span> distance. Obviously the Kantorovich distance is <span class="math inline">\(0\)</span> on this example, because <span class="math inline">\(\mu=\nu\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kantorovich</span>(mu, nu)</code></pre></div>
<pre><code>## Message: You should enter mu and nu in rational with the gmp package.</code></pre>
<pre><code>## [1] 0</code></pre>
<p>Note the message returned by both the <code>ejoinings</code> and the <code>kantorovich</code> functions. In order to get exact results, use rational numbers with the <code>gmp</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gmp)
mu &lt;-<span class="st"> </span>nu &lt;-<span class="st"> </span><span class="kw">as.bigq</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">3</span>)) <span class="co"># shorter: as.bigq(c(1,1,1), 3) </span>
<span class="kw">ejoinings</span>(mu, nu)</code></pre></div>
<pre><code>## [[1]]
##   1     2     3    
## 1 &quot;1/3&quot; &quot;0&quot;   &quot;0&quot;  
## 2 &quot;0&quot;   &quot;0&quot;   &quot;1/3&quot;
## 3 &quot;0&quot;   &quot;1/3&quot; &quot;0&quot;  
## 
## [[2]]
##   1     2     3    
## 1 &quot;1/3&quot; &quot;0&quot;   &quot;0&quot;  
## 2 &quot;0&quot;   &quot;1/3&quot; &quot;0&quot;  
## 3 &quot;0&quot;   &quot;0&quot;   &quot;1/3&quot;
## 
## [[3]]
##   1     2     3    
## 1 &quot;0&quot;   &quot;1/3&quot; &quot;0&quot;  
## 2 &quot;0&quot;   &quot;0&quot;   &quot;1/3&quot;
## 3 &quot;1/3&quot; &quot;0&quot;   &quot;0&quot;  
## 
## [[4]]
##   1     2     3    
## 1 &quot;0&quot;   &quot;1/3&quot; &quot;0&quot;  
## 2 &quot;1/3&quot; &quot;0&quot;   &quot;0&quot;  
## 3 &quot;0&quot;   &quot;0&quot;   &quot;1/3&quot;
## 
## [[5]]
##   1     2     3    
## 1 &quot;0&quot;   &quot;0&quot;   &quot;1/3&quot;
## 2 &quot;0&quot;   &quot;1/3&quot; &quot;0&quot;  
## 3 &quot;1/3&quot; &quot;0&quot;   &quot;0&quot;  
## 
## [[6]]
##   1     2     3    
## 1 &quot;0&quot;   &quot;0&quot;   &quot;1/3&quot;
## 2 &quot;1/3&quot; &quot;0&quot;   &quot;0&quot;  
## 3 &quot;0&quot;   &quot;1/3&quot; &quot;0&quot;</code></pre>
</div>
<div id="user-specified-distance" class="section level2">
<h2>User-specified distance</h2>
<p>Let us try an example with a user-specified distance. Let’s say that the state space of <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\nu\)</span> is <span class="math inline">\(\{a, b, c\}\)</span>, and then we use <code>c(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;)</code> as the vector names.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu &lt;-<span class="st"> </span><span class="kw">as.bigq</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>), <span class="dv">7</span>)
nu &lt;-<span class="st"> </span><span class="kw">as.bigq</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>), <span class="dv">9</span>)
<span class="kw">names</span>(mu) &lt;-<span class="st"> </span><span class="kw">names</span>(nu) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)</code></pre></div>
<div id="define-distance-as-a-matrix" class="section level3">
<h3>Define distance as a matrix</h3>
<p>The distance can be specified as a matrix.</p>
<p>Assume the distance <span class="math inline">\(\rho\)</span> is given by <span class="math inline">\(\rho(a,b)=1\)</span>, <span class="math inline">\(\rho(a,c)=2\)</span> and <span class="math inline">\(\rho(b,c)=4\)</span>. The <code>bigq</code> matrices offered by the <code>gmp</code> package do not handle dimension names. But, in our example, the distance <span class="math inline">\(\rho\)</span> takes only integer values, therefore one can use a numerical matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">M &lt;-<span class="st"> </span><span class="kw">matrix</span>(
  <span class="kw">c</span>(
    <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),
    <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">4</span>),
    <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>)
  ), 
  <span class="dt">byrow =</span> <span class="ot">TRUE</span>, <span class="dt">nrow =</span> <span class="dv">3</span>,
  <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)))
<span class="kw">kantorovich</span>(mu, nu, <span class="dt">dist=</span>M)</code></pre></div>
<pre><code>## Big Rational ('bigq') :
## [1] 13/63</code></pre>
<p>If the distance takes rational values, one can proceed as before with a character matrix:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">M &lt;-<span class="st"> </span><span class="kw">matrix</span>(
  <span class="kw">c</span>(
    <span class="kw">c</span>(<span class="st">&quot;0&quot;</span>, <span class="st">&quot;3/13&quot;</span>, <span class="st">&quot;2/13&quot;</span>),
    <span class="kw">c</span>(<span class="st">&quot;1/13&quot;</span>, <span class="st">&quot;0&quot;</span>, <span class="st">&quot;4/13&quot;</span>),
    <span class="kw">c</span>(<span class="st">&quot;2/13&quot;</span>, <span class="st">&quot;4/13&quot;</span>, <span class="st">&quot;0&quot;</span>)
  ), 
  <span class="dt">byrow =</span> <span class="ot">TRUE</span>, <span class="dt">nrow =</span> <span class="dv">3</span>,
  <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>), <span class="kw">c</span>(<span class="st">&quot;a&quot;</span>,<span class="st">&quot;b&quot;</span>,<span class="st">&quot;c&quot;</span>)))
<span class="kw">kantorovich</span>(mu, nu, <span class="dt">dist=</span>M)</code></pre></div>
<pre><code>## Big Rational ('bigq') :
## [1] 1/63</code></pre>
</div>
<div id="define-distance-as-a-function" class="section level3">
<h3>Define distance as a function</h3>
<p>One can enter the distance as a function. In such an example, this does not sound convenient:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rho &lt;-<span class="st"> </span>function(x,y){
  if(x==y) {
    <span class="kw">return</span>(<span class="dv">0</span>)
  } else {
    if(x==<span class="st">&quot;a&quot;</span> &amp;&amp;<span class="st"> </span>y==<span class="st">&quot;b&quot;</span>) <span class="kw">return</span>(<span class="dv">1</span>)
    if(x==<span class="st">&quot;a&quot;</span> &amp;&amp;<span class="st"> </span>y==<span class="st">&quot;c&quot;</span>) <span class="kw">return</span>(<span class="dv">2</span>)
    if(x==<span class="st">&quot;b&quot;</span> &amp;&amp;<span class="st"> </span>y==<span class="st">&quot;c&quot;</span>) <span class="kw">return</span>(<span class="dv">4</span>)
    <span class="kw">return</span>(<span class="kw">rho</span>(y,x))
  } 
}
<span class="kw">kantorovich</span>(mu, nu, <span class="dt">dist=</span>rho)</code></pre></div>
<pre><code>## Big Rational ('bigq') :
## [1] 13/63</code></pre>
<p>Using a function could be more convenient in the case when the names are numbers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(mu) &lt;-<span class="st"> </span><span class="kw">names</span>(nu) &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">3</span></code></pre></div>
<p>But one has to be aware that there are in character mode:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">names</span>(mu)</code></pre></div>
<pre><code>## [1] &quot;1&quot; &quot;2&quot; &quot;3&quot;</code></pre>
<p>Thus, one can define a distance function as follows, for example with <span class="math inline">\(\rho(x,y)=\frac{|x-y|}{1+|x-y|}\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rho &lt;-<span class="st"> </span>function(x,y){
  x &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(x); y &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(y)
  <span class="kw">return</span>(<span class="kw">as.bigq</span>(<span class="kw">abs</span>(x-y), <span class="dv">1</span>+<span class="kw">abs</span>(x-y)))
}
<span class="kw">kantorovich</span>(mu, nu, <span class="dt">dist=</span>rho)</code></pre></div>
<pre><code>## Big Rational ('bigq') :
## [1] 37/378</code></pre>
</div>
</div>
<div id="a-non-square-example" class="section level2">
<h2>A non-square example</h2>
<p>The <code>kantorovich</code> package also handles the case when <code>mu</code> and <code>nu</code> have different lengths, such as this example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu &lt;-<span class="st"> </span><span class="kw">as.bigq</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>), <span class="dv">7</span>)
nu &lt;-<span class="st"> </span><span class="kw">as.bigq</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>), <span class="dv">4</span>)
<span class="kw">names</span>(mu) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>) 
<span class="kw">names</span>(nu) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)
<span class="kw">ejoinings</span>(mu, nu)</code></pre></div>
<pre><code>## Caution: some names of mu and/or nu were missing or not compatible - automatic change</code></pre>
<pre><code>## [[1]]
##   b      c    
## a &quot;1/7&quot;  &quot;0&quot;  
## b &quot;1/28&quot; &quot;1/4&quot;
## c &quot;4/7&quot;  &quot;0&quot;  
## 
## [[2]]
##   b      c    
## a &quot;1/7&quot;  &quot;0&quot;  
## b &quot;2/7&quot;  &quot;0&quot;  
## c &quot;9/28&quot; &quot;1/4&quot;
## 
## [[3]]
##   b      c     
## a &quot;0&quot;    &quot;1/7&quot; 
## b &quot;5/28&quot; &quot;3/28&quot;
## c &quot;4/7&quot;  &quot;0&quot;   
## 
## [[4]]
##   b       c     
## a &quot;0&quot;     &quot;1/7&quot; 
## b &quot;2/7&quot;   &quot;0&quot;   
## c &quot;13/28&quot; &quot;3/28&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">kantorovich</span>(mu, nu)</code></pre></div>
<pre><code>## Caution: some names of mu and/or nu were missing or not compatible - automatic change</code></pre>
<pre><code>## Big Rational ('bigq') :
## [1] 13/28</code></pre>
<p>Note the caution message. The <code>kantorovich</code> package has to handle the fact that <code>mu</code> is given on the set <span class="math inline">\(\{a,b,c\}\)</span> while <code>nu</code> is given on the set <span class="math inline">\(\{b,c\}\)</span>. It detects that the second set is included in the first one, and then treats <code>nu</code> on the bigger set <span class="math inline">\(\{a,b,c\}\)</span> by assigning <span class="math inline">\(\nu(a)=0\)</span>. To avoid this caution message, the user has to enter this <span class="math inline">\(0\)</span> value:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nu &lt;-<span class="st"> </span><span class="kw">as.bigq</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">1</span>), <span class="dv">4</span>)
<span class="kw">names</span>(nu) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>) </code></pre></div>
</div>
</div>
<div id="other-solvers" class="section level1">
<h1>Other solvers</h1>
<p>The <code>kantorovich</code> package provides two other functions to compute the Kantorovich distance:</p>
<ul>
<li><p><code>kantorovich_lp</code>, which uses the <a href="http://web.mit.edu/lpsolve/doc/">lp_solve</a> solver with the help of the <code>lpSolve</code> package;</p></li>
<li><p><code>kantorovich_glpk</code>, which uses the <a href="http://www.gnu.org/software/glpk/">GLPK</a> solver with the help of the <code>Rglpk</code> package.</p></li>
</ul>
<p>Contrary to the <code>kantorovich</code> function, these two functions do not take care of the names of the two vectors <code>mu</code> and <code>nu</code> representing the two probability measures <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\nu\)</span>, and the distance to be minimized on average must be given as a matrix only, not a function.</p>
<p>A better precision is achieved by <code>kantorovich_glpk</code>. For instance, take the previous example for which we found <span class="math inline">\(13/63\)</span> as the exact Kantorovich distance:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>)/<span class="dv">7</span>
nu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">5</span>)/<span class="dv">9</span>
M &lt;-<span class="st"> </span><span class="kw">matrix</span>(
  <span class="kw">c</span>(
    <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>),
    <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">4</span>),
    <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">0</span>)
  ), 
  <span class="dt">byrow =</span> <span class="ot">TRUE</span>, <span class="dt">nrow =</span> <span class="dv">3</span>)
kanto_lp &lt;-<span class="st"> </span><span class="kw">kantorovich_lp</span>(mu, nu, <span class="dt">dist=</span>M)
kanto_glpk &lt;-<span class="st"> </span><span class="kw">kantorovich_glpk</span>(mu, nu, <span class="dt">dist=</span>M)</code></pre></div>
<p>Then <code>kantorovich_lp</code> does not return the better decimal approximation of <span class="math inline">\(13/63\)</span>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(kanto_lp, <span class="dt">digits=</span><span class="dv">22</span>)
## [1] 0.2063492063492062544849
<span class="kw">print</span>(kanto_glpk, <span class="dt">digits=</span><span class="dv">22</span>)
## [1] 0.2063492063492063377517
<span class="kw">print</span>(<span class="dv">13</span>/<span class="dv">63</span>, <span class="dt">digits=</span><span class="dv">22</span>)
## [1] 0.2063492063492063377517</code></pre></div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
